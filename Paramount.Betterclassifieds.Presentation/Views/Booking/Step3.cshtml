@using Paramount
@model Paramount.Betterclassifieds.Presentation.ViewModels.Booking.Step3View

@{
    ViewBag.Title = "Scheduling";
    Layout = @Url.ClientUrl("~/Views/Shared/_ApplicationLayout.cshtml");
}

<ul class="nav nav-tabs" role="tablist">
    <li>@Html.ActionLink("1", "Step1")</li>
    <li>@Html.ActionLink("2", "Step2")</li>
    <li class="active"><a href="#">Step 3</a></li>
    <li class="disabled"><a href="#">4</a></li>
</ul>

@Html.Partial("_PriceSummary")

<form id="schedulingForm" action="@Url.Action("Step3", "Booking")" method="POST" role="form">

    <div class="row top-buffer-20">
        <div class="col-xs-12">

            <div class="bs-callout bs-callout-info">
                <h4>Schedule</h4>
                <p>Your ad will be available for @Model.DurationDays  days from the date you select below.</p>
            </div>

            <div class="form-group">
                @Html.LabelFor(m => m.StartDate)
                @Html.BootstrapCalendar(m => m.StartDate)
                @Html.ValidationMessageFor(m => m.StartDate)
            </div>
        </div>
    </div>

    @*Pager*@
    <ul class="pager">
        <li class="previous">
            <button id="btnPrev" class="btn btn-large btn-default js-load" data-nav='@Url.Action("Step2")'>
                <i class="glyphicon glyphicon-arrow-left"></i> Previous
            </button>
        </li>
        <li class="next">
            <button id="btnSubmit" type="submit" class="btn btn-large btn-default">Next <i class="glyphicon glyphicon-arrow-right"></i></button>
        </li>
    </ul>
</form>

@section Scripts{
    <script>

        $(function () {

            var Step3 = function () {
                var self = this;
                self.pricelist = ko.observable({ Total: 0, LineItems: { 'Online Ad Cost': 0 } });
                self.calculate = ko.computed(function () {
                    $.get('@Url.Action("GetRate")', null, function (resp) {
                        self.pricelist(resp);
                    });
                });
            };

            var step3Model = new Step3();

            ko.applyBindings(step3Model);
        });

    </script>
}