@model MakePaymentViewModel

@{
    ViewBag.Title = "Make Payment";
    Layout = "~/Views/Shared/_ApplicationLayout.cshtml";
}

@section Scripts
{
    <script>
        $(function () {
            $('#payWithPayPal').on('click', function () {
                var eventService = new $paramount.EventService();
                eventService.payWithPayPal();
            });
        })
    </script>
}

<div class="container">
    <div class="row top-buffer-40">
        <div class="col-xs-12 well well-lg">
            <h1>
                Checkout <i class="fa fa-shopping-cart"></i>
            </h1>

            <table class="table table-responsive">
                <thead>
                    <tr>
                        <th></th>
                        <th>Name</th>
                        <th>Ticket</th>
                        <th>Price</th>
                    </tr>
                </thead>
                <tbody>

                    @foreach (var t in Model.EventTickets)
                    {
                        <tr>
                            <td><i class="fa fa-ticket"></i></td>
                            <td>@t.GuestFullName</td>
                            <td>@t.TicketName</td>
                            <td>@t.Price.GetValueOrDefault().ToString("C")</td>
                        </tr>
                    }
                </tbody>
            </table>

        </div>

        <div class="col-xs-12 col-sm-offset-8 col-sm-4">
            <h2>Total: @Model.TotalCost.ToString("C")</h2>
        </div>

        <div class="col-xs-12">
            <h3>Payment Options</h3>

            <table class="table">
                <tr>
                    <td>
                        <h4>Credit Card <i class="fa fa-credit-card"></i></h4>
                        <p>
                            Safely use our quick checkout, you can be sure we
                            do not store your card details.
                        </p>
                        <form action="@Url.EventPayWithStripe()" method="POST">
                            <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
                                    data-key="@Model.StripePublishableKey"
                                    data-amount="@Model.TotalCostCents"
                                    data-name=""
                                    data-description="Ticket Purchase"
                                    data-locale="auto"
                                    data-zip-code="false"
                                    data-currency="aud">


                            </script>
                        </form>
                    </td>
                    <td>
                        <h4>PayPal <i class="fa fa-paypal"></i></h4>
                        <p>The security you rely on – now even faster. It’s everything checkout should be. </p>
                        <p>
                            <button type="submit" class="btn btn-info js-load" id="payWithPayPal">
                                Pay with PayPal <i class="fa fa-paypal"></i>
                            </button>
                        </p>
                    </td>
                </tr>
            </table>

        </div>
    </div>
</div>