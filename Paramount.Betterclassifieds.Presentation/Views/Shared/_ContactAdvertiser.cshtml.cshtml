<div class="panel panel-primary" id="contactAdvertiserComponent">
    <div class="panel-heading">
        <h4><i class="fa fa-user"></i> Contact the organiser</h4>
    </div>

    @if (User.Identity.IsAuthenticated)
    {
        <form id="contactAdvertiserForm" data-bind="submit: sendMsg, visible: submitted() === false">
            <div class="panel-body">
                <p>
                    Need more information? Leave a message for the organiser and they will
                    be notified immediately.
                </p>
                <div class="form-group">
                    <label class="control-label" for="enquiryName">Name *</label>
                    <input class="form-control input-lg" type="text" placeholder="Your Name" data-bind="value: fullName" id="enquiryName" name="enquiryName"
                           data-val="true"
                           data-val-required="Name is required" />
                    <span class="field-validation-valid help-block" data-valmsg-for="enquiryName" data-valmsg-replace="true"></span>
                </div>
                <div class="form-group">
                    <label class="control-label" for="enquiryEmail">Email *</label>
                    <input class="form-control input-lg" type="text" placeholder="Your Email" data-bind="value: email" id="enquiryEmail" name="enquiryEmail"
                           data-val="true"
                           data-val-required="Email is required"
                           data-val-email="Email is not a valid address" />
                    <span class="field-validation-valid help-block" data-valmsg-for="enquiryEmail" data-valmsg-replace="true"></span>
                </div>
                <div class="form-group">
                    <label class="control-label" for="enquiryQuestion">Question *</label>
                    <textarea class="form-control input-lg" type="text" placeholder="Your Question" data-bind="value: question" id="enquiryQuestion" name="enquiryQuestion"
                              data-val="true"
                              data-val-required="Message is required"
                              rows="4"></textarea>
                    <span class="field-validation-valid help-block" data-valmsg-for="enquiryQuestion" data-valmsg-replace="true"></span>
                </div>
            </div>
            <div class="panel-footer clearfix">
                <button class="btn btn-primary pull-right" type="submit">Submit</button>
            </div>
        </form>

        <div class="alert alert-success" data-bind="visible: submitted() === true">
            Your message has been sent successfully!
        </div>
    }
    else
    {
        <div class="panel-body">
            <p>
                Please
                <a href="@Url.Action("Login", "Account")">
                    login or register
                </a>
                to leave a message for the organiser.
            </p>
        </div>
    }
</div>

<script>
    $(function () {
        var contactForm = new $paramount.models.ContactAdvertiser(
            @Model.AdId,
            '@Url.Action("AdEnquiry", "Listings")');
        ko.applyBindings(contactForm, document.getElementById('contactAdvertiserComponent'));
    });
</script>